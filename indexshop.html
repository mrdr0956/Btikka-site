<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…ØªØ¬Ø± Ø¨ØªÙƒØ© ğŸ›ï¸ (BTikka)</title>
  <style>
    :root {
      --bg: #0f0f12;
      --card: #17171c;
      --muted: #b6b7c0;
      --text: #ffffff;
      --accent1: #e91e63;
      --accent2: #7c4dff;
      --accent3: #00c2ff;
      --border: #2a2a31;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body { 
      margin: 0; 
      font-family: "Tahoma", system-ui, sans-serif; 
      direction: rtl; 
      background: var(--bg); 
      color: var(--text); 
      line-height: 1.6;
    }
    
    /* Header Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
    .main-header {
      padding: 30px 20px; 
      text-align: center; 
      border-bottom: 1px solid var(--border);
      background: radial-gradient(circle at 20% 30%, rgba(124,77,255,0.35), transparent 60%),
                  radial-gradient(circle at 80% 20%, rgba(233,30,99,0.35), transparent 60%),
                  linear-gradient(135deg, #1a1a1f, #0f0f12 70%);
    }
    
    /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .brand-badge {
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: #fff; 
      padding: 8px 20px; 
      border-radius: 999px;
      font-size: 18px; 
      font-weight: bold; 
      letter-spacing: 1px;
      box-shadow: 0 8px 30px rgba(124,77,255,.4);
      animation: glow 2s infinite alternate;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      display: inline-block;
      margin: 10px 0;
      min-width: 120px;
    }
    
    .brand-badge:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 35px rgba(233,30,99,.5);
    }
    
    .brand-badge:active {
      transform: scale(0.95);
    }
    
    @keyframes glow { 
      from { box-shadow: 0 0 10px rgba(124,77,255,.4); } 
      to { box-shadow: 0 0 20px rgba(233,30,99,.6); } 
    }
    
    /* Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª - ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ */
    .ads-carousel {
      display: none;
      position: relative;
      background: linear-gradient(135deg, #1a0b2e 0%, #2d1b69 100%);
      padding: 20px 0;
      border-bottom: 2px solid var(--accent2);
      overflow: hidden;
    }
    
    .ads-header {
      text-align: center;
      margin-bottom: 15px;
    }
    
    .ads-header h3 {
      margin: 0;
      color: #ffd700;
      font-size: 18px;
    }
    
    .carousel-container {
      position: relative;
      max-width: 800px;
      margin: 0 auto;
      height: 250px;
      overflow: hidden;
    }
    
    .carousel-slides {
      display: flex;
      height: 100%;
      transition: transform 0.5s ease-in-out;
    }
    
    .carousel-slide {
      flex: 0 0 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 60px;
    }
    
    .ad-content {
      display: flex;
      align-items: center;
      gap: 20px;
      max-width: 600px;
      width: 100%;
    }
    
    .ad-image-wrapper {
      flex: 0 0 200px;
      height: 180px;
      border-radius: 10px;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .ad-image {
      width: 100%;
      height: 100%;
      object-fit: scale-down;
      padding: 10px;
    }
    
    .ad-details {
      flex: 1;
      color: white;
    }
    
    .ad-name {
      font-size: 22px;
      font-weight: bold;
      margin: 0 0 10px 0;
      color: #fff;
    }
    
    .ad-description {
      font-size: 14px;
      color: #e0e0e0;
      margin: 0 0 15px 0;
      line-height: 1.5;
    }
    
    .ad-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }
    
    /* Ø£Ø³Ù‡Ù… Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ */
    .carousel-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(124, 77, 255, 0.7);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      z-index: 10;
      transition: all 0.3s ease;
    }
    
    .carousel-arrow:hover {
      background: var(--accent1);
      transform: translateY(-50%) scale(1.1);
    }
    
    .carousel-arrow.prev {
      right: 10px;
    }
    
    .carousel-arrow.next {
      left: 10px;
    }
    
    /* Ù†Ù‚Ø§Ø· Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ */
    .carousel-dots {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }
    
    .carousel-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .carousel-dot.active {
      background: #ffd700;
      transform: scale(1.2);
    }
    
    .carousel-dot:hover {
      background: var(--accent1);
    }
    
    .container { 
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 15px; 
    }

    /* ØªØ­Ø³ÙŠÙ† ØªØ®Ø·ÙŠØ· Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
    .sections {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 15px;
      animation: fadeIn 0.6s ease;
    }
    
    .section-card {
      background: #191922; 
      border: 1px solid var(--border); 
      border-radius: 8px;
      padding: 12px 8px;
      cursor: pointer; 
      transition: all .25s ease; 
      color: #eaeaf3;
      text-align: center;
      font-size: 14px;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      word-break: break-word;
    }
    
    .section-card:hover { 
      transform: translateY(-3px); 
      background: linear-gradient(135deg, var(--accent1), var(--accent2)); 
      color: #fff; 
    }

    /* Dropdown */
    .dropdown { 
      display: none; 
      margin: 15px auto; 
      text-align: center; 
      animation: slideDown 0.5s ease; 
      width: 100%;
      max-width: 300px;
    }
    
    .dropdown select {
      padding: 10px 14px; 
      border-radius: 10px; 
      border: 1px solid var(--border);
      background: #191922; 
      color: #fff; 
      font-size: 15px; 
      width: 100%;
      box-shadow: 0 8px 24px rgba(0,0,0,.25); 
      transition: all .3s ease;
      text-align: center; 
      text-align-last: center;
    }
    
    .dropdown select option { 
      color: #000; 
      background: #fff; 
      text-align: center; 
      padding: 5px;
    }

    /* Animations */
    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes slideDown { 
      from { opacity: 0; transform: translateY(-10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }

    /* ØªØ­Ø³ÙŠÙ† ØªØ®Ø·ÙŠØ· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
    .products-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-top: 20px; 
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .products-header h2 { 
      margin: 0; 
      font-size: 18px; 
      flex-grow: 1;
    }
    
    .refresh {
      background: linear-gradient(135deg, var(--accent3), var(--accent2));
      color: #fff; 
      border: none; 
      border-radius: 8px; 
      padding: 8px 14px;
      cursor: pointer; 
      font-weight: bold;
      font-size: 14px;
      white-space: nowrap;
    }
    
    .refresh:hover {
      opacity: 0.9;
    }
    
    .products { 
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
      gap: 15px;
      margin-top: 10px;
    }
    
    @media (max-width: 768px) {
      .products { 
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
        gap: 12px;
      }
      
      .sections {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
      
      .carousel-slide {
        padding: 0 20px;
      }
      
      .ad-content {
        flex-direction: column;
        text-align: center;
      }
      
      .ad-image-wrapper {
        width: 150px;
        height: 150px;
      }
    }
    
    @media (max-width: 480px) {
      .products { 
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
        gap: 10px;
      }
      
      .sections {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      }
      
      .main-header {
        padding: 20px 15px;
      }
      
      .carousel-slide {
        padding: 0 10px;
      }
      
      .ad-image-wrapper {
        width: 120px;
        height: 120px;
      }
    }
    
    /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ§Ù„ØµÙˆØ± */
    .card {
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 10px;
      overflow: hidden; 
      transition: all .2s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .card:hover { 
      transform: translateY(-3px); 
      border-color: #3b3b45; 
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .image-container {
      width: 100%;
      height: 180px;
      overflow: hidden;
      background: linear-gradient(135deg, #2a2a31, #3a3a45);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .thumb { 
      max-width: 100%;
      max-height: 100%;
      object-fit: scale-down;
      padding: 15px;
    }
    
    .card:hover .thumb {
      transform: scale(1.05);
      transition: transform 0.3s ease;
    }
    
    .content { 
      padding: 12px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    
    .name { 
      margin: 0 0 5px 0; 
      font-size: 15px; 
      font-weight: bold;
      height: 20px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .desc { 
      margin: 0 0 8px 0; 
      font-size: 12px; 
      color: var(--muted); 
      flex-grow: 1;
      height: 36px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      line-height: 1.4;
    }
    
    .price { 
      display: inline-block; 
      font-weight: bold; 
      color: #ff77a9; 
      background: rgba(233,30,99,.08); 
      border-radius: 6px; 
      padding: 4px 8px; 
      font-size: 13px;
      margin-top: 5px;
      align-self: flex-start;
    }
    
    .badge { 
      display: inline-block; 
      background: #22232b; 
      color: #b6b7c0; 
      border: 1px solid #2f3037; 
      border-radius: 6px; 
      padding: 3px 8px; 
      font-size: 11px; 
      margin-top: 6px;
      align-self: flex-start;
    }
    
    .empty { 
      color: var(--muted); 
      background: #141419; 
      border: 1px dashed #34343b; 
      border-radius: 10px; 
      padding: 20px; 
      text-align: center; 
      grid-column: 1 / -1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 200px;
    }
    
    .empty-icon {
      font-size: 40px;
      margin-bottom: 10px;
      color: var(--accent2);
    }
    
    footer { 
      text-align: center; 
      color: var(--muted); 
      padding: 20px; 
      margin-top: 30px;
      border-top: 1px solid var(--border);
      font-size: 14px;
    }
    
    h1 {
      margin: 0 0 10px;
      font-size: 24px;
    }
    
    .lead {
      margin: 5px 0;
      color: #e0e0e0;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ (Ø§Ù„ØªØ±Ø­ÙŠØ¨) -->
  <header class="main-header">
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ø¨ØªÙƒØ© ğŸ›ï¸</h1>
    <div class="brand">
      <button class="brand-badge" id="homeButton">BTikka</button>
    </div>
    <p class="lead">ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„ØªØ³ÙˆÙ‚ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ±Ø§Ø­Ø© âœ¨</p>
    <p class="lead">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ³ÙˆÙ‚ Ù…Ù†Ù‡ ğŸ‘‡</p>
  </header>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ (ÙƒØ§Ø±ÙˆØ³ÙŠÙ„) -->
  <div class="ads-carousel" id="adsCarousel">
    <div class="ads-header">
      <h3>ğŸ† Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ø¯ÙŠÙ†Ø§</h3>
    </div>
    <div class="carousel-container">
      <div class="carousel-slides" id="carouselSlides">
        <!-- Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
      </div>
      <button class="carousel-arrow prev" id="prevBtn">â€¹</button>
      <button class="carousel-arrow next" id="nextBtn">â€º</button>
    </div>
    <div class="carousel-dots" id="carouselDots">
      <!-- Ø§Ù„Ù†Ù‚Ø§Ø· ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
    </div>
  </div>

  <div class="container">
    <div class="sections" id="sections"></div>
    <div class="dropdown" id="dropdown"><select id="dropdownSelect"></select></div>

    <div class="products-header">
      <h2 id="current-section">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
      <button class="refresh" id="refresh">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
    </div>
    <div class="products" id="products"></div>
  </div>

  <footer>Â© BTikka â€” ØªØ³ÙˆÙ‚Ùƒ Ø£Ø³Ù‡Ù„ Ù…Ø¹Ù†Ø§</footer>

  <script>
    const SECTIONS = [
      "ğŸ° Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª",
      "ğŸ›ï¸ Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª â€“ Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©",
      "âš¡ Ø£Ø¯ÙˆØ§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ",
      "ğŸ”Œ Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©",
      "ğŸ½ï¸ Ø§Ø¯ÙˆØ§Øª Ø¨Ù„Ø§Ø³ØªÙŠÙƒÙŠØ©",
      "ğŸ Ù‡Ø¯Ø§ÙŠØ§",
      "ğŸ—ï¸ Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØªØ´Ø·ÙŠØ¨",
      "ğŸ’Š Ø£Ø¯ÙˆÙŠØ© ÙˆÙ…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø·Ø¨ÙŠØ©"
    ];

    // Ø¹Ù†Ø§ØµØ± DOM
    const secEl = document.getElementById("sections");
    const dropdown = document.getElementById("dropdown");
    const dropdownSelect = document.getElementById("dropdownSelect");
    const prodEl = document.getElementById("products");
    const titleEl = document.getElementById("current-section");
    const refreshBtn = document.getElementById("refresh");
    const homeButton = document.getElementById("homeButton");
    const adsCarousel = document.getElementById("adsCarousel");
    const carouselSlides = document.getElementById("carouselSlides");
    const carouselDots = document.getElementById("carouselDots");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    let currentSlide = 0;
    let slideInterval;
    let featuredShops = [];
    let allProducts = [];

    // ========== Ø¯Ø§Ù„Ø§Øª Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ==========

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    async function initCarousel() {
      try {
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        const settings = await fetchSettings();
        const headerMode = settings.header_mode || "welcome";
        
        if (headerMode === "welcome") {
          adsCarousel.style.display = "none";
          return;
        }
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
        featuredShops = await fetchFeaturedShops();
        
        if (!featuredShops || featuredShops.length === 0) {
          adsCarousel.style.display = "none";
          return;
        }
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª
        allProducts = await fetchProductsJson();
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
        adsCarousel.style.display = "block";
        renderCarouselSlides();
        renderCarouselDots();
        startCarousel();
        
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„:", err);
        adsCarousel.style.display = "none";
      }
    }

    // Ø¹Ø±Ø¶ Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    function renderCarouselSlides() {
      carouselSlides.innerHTML = "";
      
      featuredShops.forEach((shop, index) => {
        const slide = document.createElement("div");
        slide.className = "carousel-slide";
        slide.dataset.index = index;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        const shopExists = checkShopExists(shop.name);
        
        // Ù†Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ø¨Ù†ÙØ³ Ø§Ù„Ø´ÙƒÙ„
        slide.style.cursor = shopExists ? "pointer" : "default";
        
        // Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø±
        slide.onclick = () => {
          if (shopExists) {
            // Ø§Ù„Ù…Ø­Ù„ Ù…ÙˆØ¬ÙˆØ¯: Ù†Ø°Ù‡Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù…Ù†ØªØ¬Ø§ØªÙ‡
            goToShopProducts(shop.name);
          }
          // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: Ù„Ø§ Ù†ÙØ¹Ù„ Ø´ÙŠØ¦Ø§Ù‹
        };
        
        slide.innerHTML = `
          <div class="ad-content">
            <div class="ad-image-wrapper">
              <img class="ad-image" src="${shop.photo}" alt="${shop.name}"
                   onerror="this.src='https://via.placeholder.com/400x300/7c4dff/ffffff?text=â­'">
            </div>
            <div class="ad-details">
              <h3 class="ad-name">${shop.name}</h3>
              <p class="ad-description">${shop.description || "Ù…Ø­Ù„ Ù…Ù…ÙŠØ² ÙÙŠ Ù…ØªØ¬Ø± Ø¨ØªÙƒØ©"}</p>
              <div class="ad-badge">â­ Ù…Ø­Ù„ Ù…Ù…ÙŠØ²</div>
            </div>
          </div>
        `;
        
        carouselSlides.appendChild(slide);
      });
      
      updateCarouselPosition();
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ù„
    function goToShopProducts(shopName) {
      // 1. Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
      secEl.style.display = "none";
      dropdown.style.display = "block";
      
      // 2. Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      const restaurantSection = "ğŸ° Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª";
      dropdownSelect.value = restaurantSection;
      
      // 3. Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      showSection(restaurantSection);
      
      // 4. Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù…ØŒ Ù†Ù†ØªÙ‚Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…Ø­Ù„
      setTimeout(() => {
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
        const shopCards = document.querySelectorAll('.card');
        let found = false;
        
        shopCards.forEach(card => {
          const cardTitle = card.querySelector('.name')?.textContent;
          if (cardTitle === shopName) {
            found = true;
            // ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
            card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
            card.style.boxShadow = "0 0 0 3px #ffd700";
            card.style.transform = "scale(1.05)";
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
            card.onclick = () => {
              showShopProducts(restaurantSection, shopName);
            };
            
            // Ø§Ù„Ù†Ù‚Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ±
            setTimeout(() => {
              card.click();
            }, 300);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ² Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
              card.style.boxShadow = "";
              card.style.transform = "";
            }, 3000);
          }
        });
        
        // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø§Ù„Ù…Ø­Ù„ØŒ Ù†Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
        if (!found) {
          alert(`Ø§Ù„Ù…Ø­Ù„ "${shopName}" ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù….`);
        }
      }, 1000);
    }

    // Ø¹Ø±Ø¶ Ù†Ù‚Ø§Ø· Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    function renderCarouselDots() {
      carouselDots.innerHTML = "";
      
      featuredShops.forEach((_, index) => {
        const dot = document.createElement("span");
        dot.className = `carousel-dot ${index === currentSlide ? 'active' : ''}`;
        dot.dataset.index = index;
        dot.onclick = () => goToSlide(index);
        carouselDots.appendChild(dot);
      });
    }

    // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ¶Ø¹ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    function updateCarouselPosition() {
      carouselSlides.style.transform = `translateX(-${currentSlide * 100}%)`;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ø´Ø·Ø©
      document.querySelectorAll('.carousel-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlide);
      });
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø´Ø±ÙŠØ­Ø© Ù…Ø­Ø¯Ø¯Ø©
    function goToSlide(index) {
      currentSlide = index;
      if (currentSlide >= featuredShops.length) currentSlide = 0;
      if (currentSlide < 0) currentSlide = featuredShops.length - 1;
      updateCarouselPosition();
      resetCarouselInterval();
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
    function nextSlide() {
      goToSlide(currentSlide + 1);
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    function prevSlide() {
      goToSlide(currentSlide - 1);
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    function startCarousel() {
      clearInterval(slideInterval);
      slideInterval = setInterval(nextSlide, 10000); // ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ
    }

    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
    function resetCarouselInterval() {
      clearInterval(slideInterval);
      slideInterval = setInterval(nextSlide, 10000);
    }

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø­Ù„
    function checkShopExists(shopName) {
      return allProducts.some(product => 
        product.shop && product.shop.trim() === shopName.trim()
      );
    }

    // ========== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ==========

    // Ø¬Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
    async function fetchSettings() {
      try {
        const url = `settings.json?ts=${Date.now()}`;
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) return { header_mode: "welcome" };
        return await res.json();
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:", err);
        return { header_mode: "welcome" };
      }
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
    async function fetchFeaturedShops() {
      try {
        const url = `featured_shops.json?ts=${Date.now()}`;
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) return [];
        return await res.json();
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©:", err);
        return [];
      }
    }

    async function fetchProductsJson() {
      const url = `products.json?ts=${Date.now()}`;
      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª");
      return await res.json();
    }

    // ========== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ==========

    // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    function goToHomePage() {
      secEl.style.display = "grid";
      dropdown.style.display = "none";
      dropdownSelect.selectedIndex = 0;
      showRandomProducts();
      initCarousel();
      window.scrollTo({ top: 0, behavior: 'smooth' });
      titleEl.textContent = "Ù…Ù†ØªØ¬Ø§Øª Ù…Ø®ØªØ§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ âœ¨";
    }

    // Ø¨Ù†Ø§Ø¡ Tabs + Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    SECTIONS.forEach(sec => {
      const card = document.createElement("div");
      card.className = "section-card";
      card.textContent = sec;
      card.onclick = () => {
        secEl.style.display = "none";
        dropdown.style.display = "block";
        dropdownSelect.value = sec;
        showSection(sec);
      };
      secEl.appendChild(card);

      const option = document.createElement("option");
      option.value = sec;
      option.textContent = sec;
      dropdownSelect.appendChild(option);
    });

    dropdownSelect.onchange = () => {
      const sec = dropdownSelect.value;
      showSection(sec);
    };

    function renderCard({ title, subtitle, photo, description, price, badge, onClick }) {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="image-container">
          <img class="thumb" src="${photo}" alt="${title}"
               onerror="this.src='https://via.placeholder.com/400x300/ffffff/000000?text=BTikka'">
        </div>
        <div class="content">
          <h3 class="name">${title}</h3>
          ${subtitle ? `<div class="badge">${subtitle}</div>` : ""}
          <p class="desc">${description || ""}</p>
          ${price ? `<span class="price">Ø§Ù„Ø³Ø¹Ø±: ${price} Ù„.Ø³</span>` : ""}
          ${badge ? `<div class="badge">${badge}</div>` : ""}
        </div>
      `;
      if (onClick) {
        card.style.cursor = "pointer";
        card.onclick = onClick;
      }
      prodEl.appendChild(card);
    }

    // Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„: Ù…Ù†ØªØ¬Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ù†ÙˆØ¹ product (Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª)
    async function showRandomProducts() {
      titleEl.textContent = "Ù…Ù†ØªØ¬Ø§Øª Ù…Ø®ØªØ§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ âœ¨";
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const productsOnly = items.filter(i => (i.kind || "product") === "product");
        const shuffled = [...productsOnly].sort(() => 0.5 - Math.random());
        const selected = shuffled.slice(0, 16);
        selected.forEach(p => renderCard({
          title: p.name,
          photo: p.photo,
          description: p.description,
          price: p.price,
          badge: p.type
        }));
        if (!prodEl.children.length) {
          prodEl.innerHTML = `
            <div class="empty">
              <div class="empty-icon">âœ¨</div>
              <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù†.</p>
              <p style="font-size: 12px; margin-top: 10px;">Ø³ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹!</p>
            </div>`;
        }
      } catch (err) {
        prodEl.innerHTML = `
          <div class="empty">
            <div class="empty-icon">âš ï¸</div>
            <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>
            <p style="font-size: 12px; margin-top: 10px;">Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹</p>
          </div>`;
        console.error(err);
      }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
    async function showSection(section) {
      titleEl.textContent = `Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€” ${section}`;
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const secItems = items.filter(i => (i.section || "").trim() === section.trim());

        if (section.includes("Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª")) {
          const shops = secItems.filter(i => i.kind === "shop");
          const products = secItems.filter(i => (i.kind || "product") === "product");

          if (shops.length === 0 && products.length === 0) {
            prodEl.innerHTML = `
              <div class="empty">
                <div class="empty-icon">âœ¨</div>
                <p>Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø³ÙˆÙ ØªÙ†Ø²Ù„ Ø§Ù„Ù…Ø­Ù„Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
                <p style="font-size: 12px; margin-top: 10px;">ÙÙŠ Ù‚Ø³Ù… "${section}"</p>
              </div>`;
            return;
          }

          shops.forEach(shop => renderCard({
            title: shop.shop,
            subtitle: shop.type,
            photo: shop.photo,
            description: shop.description,
            badge: "Ù…Ø­Ù„",
            onClick: () => showShopProducts(section, shop.shop)
          }));

          if (shops.length === 0 && products.length > 0) {
            products.forEach(p => renderCard({
              title: p.name,
              photo: p.photo,
              description: p.description,
              price: p.price,
              badge: p.type
            }));
          }
        } else {
          const products = secItems.filter(i => (i.kind || "product") === "product");
          if (products.length === 0) {
            prodEl.innerHTML = `
              <div class="empty">
                <div class="empty-icon">âœ¨</div>
                <p>Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø³ÙˆÙ ØªÙ†Ø²Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
                <p style="font-size: 12px; margin-top: 10px;">ÙÙŠ Ù‚Ø³Ù… "${section}"</p>
              </div>`;
            return;
          }
          products.forEach(p => renderCard({
            title: p.name,
            photo: p.photo,
            description: p.description,
            price: p.price,
            badge: p.type
          }));
        }

        prodEl.scrollIntoView({ behavior: "smooth", block: "start" });
      } catch (err) {
        prodEl.innerHTML = `
          <div class="empty">
            <div class="empty-icon">âš ï¸</div>
            <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>
            <p style="font-size: 12px; margin-top: 10px;">Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§</p>
          </div>`;
        console.error(err);
      }
    }

    // Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø­Ù„ Ù…Ø­Ø¯Ø¯ Ø¯Ø§Ø®Ù„ Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
    async function showShopProducts(section, shopName) {
      titleEl.textContent = `Ù…Ù†ØªØ¬Ø§Øª â€” ${section} / ${shopName}`;
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const products = items.filter(
          i => (i.section || "").trim() === section.trim() &&
               (i.kind || "product") === "product" &&
               (i.shop || "").trim() === shopName.trim()
        );

        if (products.length === 0) {
          prodEl.innerHTML = `
            <div class="empty">
              <div class="empty-icon">ğŸª</div>
              <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ù„ Ø­Ø§Ù„ÙŠÙ‹Ø§.</p>
            </div>`;
          return;
        }

        products.forEach(p => renderCard({
          title: p.name,
          photo: p.photo,
          description: p.description,
          price: p.price,
          badge: p.type
        }));
      } catch (err) {
        prodEl.innerHTML = `
          <div class="empty">
            <div class="empty-icon">âš ï¸</div>
            <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>
            <p style="font-size: 12px; margin-top: 10px;">Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§</p>
          </div>`;
        console.error(err);
      }
    }

    // Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
    refreshBtn.onclick = async () => {
      const t = titleEl.textContent;
      if (t.includes("â€”")) {
        const afterDash = t.split("â€”")[1].trim();
        if (afterDash.includes("/")) {
          const [section, shop] = afterDash.split("/").map(s => s.trim());
          showShopProducts(section, shop);
        } else {
          showSection(afterDash);
        }
      } else {
        showRandomProducts();
      }
      await initCarousel();
    };

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø£ÙˆÙ„ Ù…Ø±Ø©
    document.addEventListener("DOMContentLoaded", async () => {
      secEl.style.display = "grid";
      dropdown.style.display = "none";
      showRandomProducts();
      
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
      await initCarousel();
      
      // Ø¥Ø¶Ø§ÙØ© Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
      homeButton.addEventListener("click", goToHomePage);
      prevBtn.addEventListener("click", () => {
        prevSlide();
        resetCarouselInterval();
      });
      nextBtn.addEventListener("click", () => {
        nextSlide();
        resetCarouselInterval();
      });
      
      // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ…
      adsCarousel.addEventListener("mouseenter", () => {
        clearInterval(slideInterval);
      });
      
      adsCarousel.addEventListener("mouseleave", () => {
        startCarousel();
      });
    });
  </script>
</body>
</html>
