<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…ØªØ¬Ø± Ø¨ØªÙƒØ© ğŸ›ï¸ (BTikka)</title>
  <style>
    :root {
      --bg: #0f0f12;
      --card: #17171c;
      --muted: #b6b7c0;
      --text: #ffffff;
      --accent1: #e91e63;
      --accent2: #7c4dff;
      --accent3: #00c2ff;
      --border: #2a2a31;
      --ad-bg: linear-gradient(135deg, #1a0b2e 0%, #2d1b69 100%);
      --ad-card: rgba(255, 255, 255, 0.1);
    }
    body { margin: 0; font-family: "Tahoma", system-ui, sans-serif; direction: rtl; background: var(--bg); color: var(--text); }
    
    /* Header Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
    .main-header {
      padding: 40px 20px; text-align: center; border-bottom: 1px solid var(--border);
      background: radial-gradient(circle at 20% 30%, rgba(124,77,255,0.35), transparent 60%),
                  radial-gradient(circle at 80% 20%, rgba(233,30,99,0.35), transparent 60%),
                  linear-gradient(135deg, #1a1a1f, #0f0f12 70%);
    }
    
    /* Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
    .ads-section {
      display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
      background: var(--ad-bg);
      padding: 20px;
      border-bottom: 2px solid var(--accent2);
    }
    
    .ads-header {
      text-align: center;
      margin-bottom: 15px;
    }
    
    .ads-header h3 {
      margin: 0;
      color: #ffd700;
      font-size: 18px;
    }
    
    .ads-slider {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding: 10px;
      scrollbar-width: thin;
      scrollbar-color: var(--accent2) var(--bg);
    }
    
    .ads-slider::-webkit-scrollbar {
      height: 8px;
    }
    
    .ads-slider::-webkit-scrollbar-track {
      background: var(--bg);
      border-radius: 4px;
    }
    
    .ads-slider::-webkit-scrollbar-thumb {
      background: var(--accent2);
      border-radius: 4px;
    }
    
    .ad-card {
      flex: 0 0 auto;
      width: 180px;
      background: var(--ad-card);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid rgba(124, 77, 255, 0.3);
    }
    
    .ad-card:hover {
      transform: translateY(-5px);
      border-color: var(--accent1);
      box-shadow: 0 10px 20px rgba(124, 77, 255, 0.2);
    }
    
    .ad-image {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 8px;
    }
    
    .ad-name {
      font-weight: bold;
      font-size: 14px;
      margin: 5px 0;
      color: #fff;
    }
    
    .ad-desc {
      font-size: 12px;
      color: #ccc;
      margin: 5px 0;
      line-height: 1.3;
      height: 36px;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .ad-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: white;
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 12px;
      margin-top: 5px;
    }
    
    .brand-badge {
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: #fff; padding: 6px 16px; border-radius: 999px;
      font-size: 16px; font-weight: bold; letter-spacing: 1px;
      box-shadow: 0 8px 30px rgba(124,77,255,.4);
      animation: glow 2s infinite alternate;
    }
    
    @keyframes glow { 
      from { box-shadow: 0 0 10px rgba(124,77,255,.4); } 
      to { box-shadow: 0 0 20px rgba(233,30,99,.6); } 
    }

    .container { max-width: 1100px; margin: 0 auto; padding: 20px; }

    /* Tabs */
    .sections {
      display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;
      margin-top: 18px; animation: fadeIn 0.6s ease;
    }
    .section-card {
      background: #191922; border: 1px solid var(--border); border-radius: 8px;
      padding: 10px 16px; cursor: pointer; transition: all .25s ease; color: #eaeaf3;
    }
    .section-card:hover { 
      transform: translateY(-3px); 
      background: linear-gradient(135deg, var(--accent1), var(--accent2)); 
      color: #fff; 
    }

    /* Dropdown */
    .dropdown { 
      display: none; 
      margin: 20px auto; 
      text-align: center; 
      animation: slideDown 0.5s ease; 
    }
    
    .dropdown select {
      padding: 10px 14px; 
      border-radius: 10px; 
      border: 1px solid var(--border);
      background: #191922; 
      color: #fff; 
      font-size: 15px; 
      min-width: 240px;
      box-shadow: 0 8px 24px rgba(0,0,0,.25); 
      transition: all .3s ease;
      text-align: center; 
      text-align-last: center;
    }
    
    .dropdown select option { 
      color: #000; 
      background: #fff; 
      text-align: center; 
    }

    /* Animations */
    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes slideDown { 
      from { opacity: 0; transform: translateY(-10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }

    .products-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-top: 24px; 
      margin-bottom: 12px; 
    }
    
    .products-header h2 { 
      margin: 0; 
      font-size: 20px; 
    }
    
    .refresh {
      background: linear-gradient(135deg, var(--accent3), var(--accent2));
      color: #fff; 
      border: none; 
      border-radius: 8px; 
      padding: 8px 12px;
      cursor: pointer; 
      font-weight: bold;
    }
    
    .products { 
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); 
      gap: 16px; 
    }
    
    .card {
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 12px;
      overflow: hidden; 
      transition: all .2s ease;
    }
    
    .card:hover { 
      transform: translateY(-3px); 
      border-color: #3b3b45; 
    }
    
    .thumb { 
      width: 100%; 
      height: 180px; 
      object-fit: cover; 
      background: #fff; 
    }
    
    .content { 
      padding: 10px; 
    }
    
    .name { 
      margin: 4px 0; 
      font-size: 16px; 
      font-weight: bold; 
    }
    
    .desc { 
      margin: 4px 0 8px; 
      font-size: 13px; 
      color: var(--muted); 
      min-height: 32px; 
    }
    
    .price { 
      display: inline-block; 
      font-weight: bold; 
      color: #ff77a9; 
      background: rgba(233,30,99,.08); 
      border-radius: 6px; 
      padding: 4px 8px; 
    }
    
    .badge { 
      display: inline-block; 
      background: #22232b; 
      color: #b6b7c0; 
      border: 1px solid #2f3037; 
      border-radius: 6px; 
      padding: 3px 8px; 
      font-size: 12px; 
      margin-top: 6px; 
    }
    
    .empty { 
      color: var(--muted); 
      background: #141419; 
      border: 1px dashed #34343b; 
      border-radius: 10px; 
      padding: 14px; 
      text-align: center; 
      grid-column: 1 / -1; 
    }
    
    footer { 
      text-align: center; 
      color: var(--muted); 
      padding: 20px; 
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ (Ø§Ù„ØªØ±Ø­ÙŠØ¨) -->
  <header class="main-header">
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ø¨ØªÙƒØ© ğŸ›ï¸</h1>
    <div class="brand"><span class="brand-badge">BTikka</span></div>
    <p class="lead">ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„ØªØ³ÙˆÙ‚ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ±Ø§Ø­Ø© âœ¨</p>
    <p class="lead">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ³ÙˆÙ‚ Ù…Ù†Ù‡ ğŸ‘‡</p>
  </header>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„) -->
  <div class="ads-section" id="adsSection">
    <div class="ads-header">
      <h3>ğŸ† Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ø¯ÙŠÙ†Ø§</h3>
    </div>
    <div class="ads-slider" id="adsSlider">
      <!-- Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
    </div>
  </div>

  <div class="container">
    <div class="sections" id="sections"></div>
    <div class="dropdown" id="dropdown"><select id="dropdownSelect"></select></div>

    <div class="products-header">
      <h2 id="current-section">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
      <button class="refresh" id="refresh">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
    </div>
    <div class="products" id="products"></div>
  </div>

  <footer>Â© BTikka â€” ØªØ³ÙˆÙ‚Ùƒ Ø£Ø³Ù‡Ù„ Ù…Ø¹Ù†Ø§</footer>

  <script>
    const SECTIONS = [
      "ğŸ° Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª",
      "ğŸ›ï¸ Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª â€“ Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©",
      "âš¡ Ø£Ø¯ÙˆØ§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ",
      "ğŸ”Œ Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©",
      "ğŸ½ï¸ Ø§Ø¯ÙˆØ§Øª Ø¨Ù„Ø§Ø³ØªÙŠÙƒÙŠØ©",
      "ğŸ Ù‡Ø¯Ø§ÙŠØ§",
      "ğŸ—ï¸ Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØªØ´Ø·ÙŠØ¨",
      "ğŸ’Š Ø£Ø¯ÙˆÙŠØ© ÙˆÙ…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø·Ø¨ÙŠØ©"
    ];

    // Ø¹Ù†Ø§ØµØ± DOM
    const secEl = document.getElementById("sections");
    const dropdown = document.getElementById("dropdown");
    const dropdownSelect = document.getElementById("dropdownSelect");
    const prodEl = document.getElementById("products");
    const titleEl = document.getElementById("current-section");
    const refreshBtn = document.getElementById("refresh");
    const adsSection = document.getElementById("adsSection");
    const adsSlider = document.getElementById("adsSlider");

    // ========== Ø¯Ø§Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ==========

    // Ø¬Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
    async function fetchSettings() {
      try {
        const url = `settings.json?ts=${Date.now()}`;
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) return { header_mode: "welcome" };
        return await res.json();
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:", err);
        return { header_mode: "welcome" };
      }
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
    async function fetchFeaturedShops() {
      try {
        const url = `featured_shops.json?ts=${Date.now()}`;
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) return [];
        return await res.json();
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©:", err);
        return [];
      }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
    async function displayAds() {
      try {
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        const settings = await fetchSettings();
        const headerMode = settings.header_mode || "welcome";
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆØ¶Ø¹ ØªØ±Ø­ÙŠØ¨ ÙÙ‚Ø·ØŒ Ù†Ø®ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        if (headerMode === "welcome") {
          adsSection.style.display = "none";
          return;
        }
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
        const featuredShops = await fetchFeaturedShops();
        
        // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ù…Ø­Ù„Ø§Øª Ù…Ù…ÙŠØ²Ø©ØŒ Ù†Ø®ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        if (!featuredShops || featuredShops.length === 0) {
          adsSection.style.display = "none";
          return;
        }
        
        // Ø¹Ø±Ø¶ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        adsSection.style.display = "block";
        adsSlider.innerHTML = "";
        
        // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„ Ù…Ø­Ù„ Ù…Ù…ÙŠØ² ÙƒØ¥Ø¹Ù„Ø§Ù†
        featuredShops.forEach(shop => {
          const adCard = document.createElement("div");
          adCard.className = "ad-card";
          adCard.onclick = () => {
            // Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŒ Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù… ÙˆÙ†Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø­Ù„
            selectRestaurantSection(shop.name);
          };
          
          adCard.innerHTML = `
            <img class="ad-image" src="${shop.photo}" alt="${shop.name}"
                 onerror="this.src='https://via.placeholder.com/400x300/7c4dff/ffffff?text=â­'">
            <div class="ad-name">${shop.name}</div>
            <div class="ad-desc">${shop.description || "Ù…Ø­Ù„ Ù…Ù…ÙŠØ²"}</div>
            <div class="ad-badge">â­ Ù…Ù…ÙŠØ²</div>
          `;
          
          adsSlider.appendChild(adCard);
        });
        
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª:", err);
        adsSection.style.display = "none";
      }
    }

    // Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù… ÙˆØ§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø­Ù„
    function selectRestaurantSection(shopName) {
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
      secEl.style.display = "none";
      dropdown.style.display = "block";
      
      // Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      const restaurantSection = "ğŸ° Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª";
      dropdownSelect.value = restaurantSection;
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù…
      showSection(restaurantSection);
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„Ù‚Ø³Ù… Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
      setTimeout(() => {
        const shopCards = document.querySelectorAll('.card');
        shopCards.forEach(card => {
          if (card.querySelector('.name').textContent === shopName) {
            card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± ØªÙ…ÙŠÙŠØ²
            card.style.boxShadow = "0 0 0 3px #ffd700";
            card.style.transform = "scale(1.05)";
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ² Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
              card.style.boxShadow = "";
              card.style.transform = "";
            }, 3000);
          }
        });
      }, 1000);
    }

    // ========== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£ØµÙ„ÙŠØ© (Ù…Ø¹Ø¯Ù„Ø©) ==========

    // Ø¨Ù†Ø§Ø¡ Tabs + Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    SECTIONS.forEach(sec => {
      const card = document.createElement("div");
      card.className = "section-card";
      card.textContent = sec;
      card.onclick = () => {
        secEl.style.display = "none";
        dropdown.style.display = "block";
        dropdownSelect.value = sec;
        showSection(sec);
      };
      secEl.appendChild(card);

      const option = document.createElement("option");
      option.value = sec;
      option.textContent = sec;
      dropdownSelect.appendChild(option);
    });

    dropdownSelect.onchange = () => {
      const sec = dropdownSelect.value;
      showSection(sec);
    };

    async function fetchProductsJson() {
      const url = `products.json?ts=${Date.now()}`;
      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª");
      return await res.json();
    }

    function renderCard({ title, subtitle, photo, description, price, badge, onClick }) {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <img class="thumb" src="${photo}" alt="${title}"
             onerror="this.src='https://via.placeholder.com/400x300/ffffff/000000?text=BTikka'">
        <div class="content">
          <h3 class="name">${title}</h3>
          ${subtitle ? `<div class="badge">${subtitle}</div>` : ""}
          <p class="desc">${description || ""}</p>
          ${price ? `<span class="price">Ø§Ù„Ø³Ø¹Ø±: ${price} Ù„.Ø³</span>` : ""}
          ${badge ? `<div class="badge">${badge}</div>` : ""}
        </div>
      `;
      if (onClick) {
        card.style.cursor = "pointer";
        card.onclick = onClick;
      }
      prodEl.appendChild(card);
    }

    // Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„: Ù…Ù†ØªØ¬Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ù†ÙˆØ¹ product (Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª)
    async function showRandomProducts() {
      titleEl.textContent = "Ù…Ù†ØªØ¬Ø§Øª Ù…Ø®ØªØ§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ âœ¨";
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const productsOnly = items.filter(i => (i.kind || "product") === "product");
        const shuffled = [...productsOnly].sort(() => 0.5 - Math.random());
        const selected = shuffled.slice(0, 16);
        selected.forEach(p => renderCard({
          title: p.name,
          photo: p.photo,
          description: p.description,
          price: p.price,
          badge: p.type
        }));
        if (!prodEl.children.length) {
          prodEl.innerHTML = `<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù†. âœ¨</div>`;
        }
      } catch (err) {
        prodEl.innerHTML = `<div class="empty">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§.</div>`;
        console.error(err);
      }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
    async function showSection(section) {
      titleEl.textContent = `Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€” ${section}`;
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const secItems = items.filter(i => (i.section || "").trim() === section.trim());

        // Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª: Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø£ÙˆÙ„Ù‹Ø§ (kind="shop")
        if (section.includes("Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª")) {
          const shops = secItems.filter(i => i.kind === "shop");
          const products = secItems.filter(i => (i.kind || "product") === "product");

          if (shops.length === 0 && products.length === 0) {
            prodEl.innerHTML = `<div class="empty">âœ¨ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø³ÙˆÙ ØªÙ†Ø²Ù„ Ø§Ù„Ù…Ø­Ù„Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‚Ø³Ù… "${section}" âœ¨</div>`;
            return;
          }

          // Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ù„Ø§Øª ÙƒØ¨Ø·Ø§Ù‚Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù†Ù‚Ø±
          shops.forEach(shop => renderCard({
            title: shop.shop,
            subtitle: shop.type,
            photo: shop.photo,
            description: shop.description,
            badge: "Ù…Ø­Ù„",
            onClick: () => showShopProducts(section, shop.shop)
          }));

          // Ø¥Ø°Ø§ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ù„Ø§Øª Ù„ÙƒÙ† ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø¯ÙˆÙ† shopØŒ Ø§Ø¹Ø±Ø¶Ù‡Ø§ ÙƒÙ…Ù†ØªØ¬Ø§Øª Ø¹Ø§Ù…Ø©
          if (shops.length === 0 && products.length > 0) {
            products.forEach(p => renderCard({
              title: p.name,
              photo: p.photo,
              description: p.description,
              price: p.price,
              badge: p.type
            }));
          }
        } else {
          // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…: Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙ‚Ø· (Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø£ÙŠ Ø¹Ù†Ø§ØµØ± kind="shop")
          const products = secItems.filter(i => (i.kind || "product") === "product");
          if (products.length === 0) {
            prodEl.innerHTML = `<div class="empty">âœ¨ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø³ÙˆÙ ØªÙ†Ø²Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‚Ø³Ù… "${section}" âœ¨</div>`;
            return;
          }
          products.forEach(p => renderCard({
            title: p.name,
            photo: p.photo,
            description: p.description,
            price: p.price,
            badge: p.type
          }));
        }

        prodEl.scrollIntoView({ behavior: "smooth", block: "start" });
      } catch (err) {
        prodEl.innerHTML = `<div class="empty">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§.</div>`;
        console.error(err);
      }
    }

    // Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø­Ù„ Ù…Ø­Ø¯Ø¯ Ø¯Ø§Ø®Ù„ Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
    async function showShopProducts(section, shopName) {
      titleEl.textContent = `Ù…Ù†ØªØ¬Ø§Øª â€” ${section} / ${shopName}`;
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const products = items.filter(
          i => (i.section || "").trim() === section.trim() &&
               (i.kind || "product") === "product" &&
               (i.shop || "").trim() === shopName.trim()
        );

        if (products.length === 0) {
          prodEl.innerHTML = `<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ù„ Ø­Ø§Ù„ÙŠÙ‹Ø§.</div>`;
          return;
        }

        products.forEach(p => renderCard({
          title: p.name,
          photo: p.photo,
          description: p.description,
          price: p.price,
          badge: p.type
        }));
      } catch (err) {
        prodEl.innerHTML = `<div class="empty">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§.</div>`;
        console.error(err);
      }
    }

    // Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
    refreshBtn.onclick = () => {
      const t = titleEl.textContent;
      if (t.includes("â€”")) {
        const afterDash = t.split("â€”")[1].trim();
        // Ø¥Ø°Ø§ ÙƒÙ†Ø§ Ø¯Ø§Ø®Ù„ Ù…Ø­Ù„: "Ù…Ù†ØªØ¬Ø§Øª â€” Ø§Ù„Ù‚Ø³Ù… / Ø§Ù„Ù…Ø­Ù„"
        if (afterDash.includes("/")) {
          const [section, shop] = afterDash.split("/").map(s => s.trim());
          showShopProducts(section, shop);
        } else {
          showSection(afterDash);
        }
      } else {
        showRandomProducts();
      }
    };

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
    refreshBtn.onclick = async () => {
      const t = titleEl.textContent;
      if (t.includes("â€”")) {
        const afterDash = t.split("â€”")[1].trim();
        if (afterDash.includes("/")) {
          const [section, shop] = afterDash.split("/").map(s => s.trim());
          showShopProducts(section, shop);
        } else {
          showSection(afterDash);
        }
      } else {
        showRandomProducts();
      }
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø£ÙŠØ¶Ø§Ù‹
      await displayAds();
    };

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø£ÙˆÙ„ Ù…Ø±Ø©
    document.addEventListener("DOMContentLoaded", async () => {
      secEl.style.display = "flex";
      dropdown.style.display = "none";
      showRandomProducts();
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
      await displayAds();
    });
  </script>
</body>
</html>
