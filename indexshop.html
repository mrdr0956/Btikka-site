<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…ØªØ¬Ø± Ø¨ØªÙƒØ© ğŸ›ï¸ (BTikka)</title>
  <style>
    :root {
      --bg: #0f0f12;
      --card: #17171c;
      --muted: #b6b7c0;
      --text: #ffffff;
      --accent1: #e91e63;
      --accent2: #7c4dff;
      --accent3: #00c2ff;
      --border: #2a2a31;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body { 
      margin: 0; 
      font-family: "Tahoma", system-ui, sans-serif; 
      direction: rtl; 
      background: var(--bg); 
      color: var(--text); 
      line-height: 1.6;
    }
    
    /* Header Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
    .main-header {
      padding: 30px 20px; 
      text-align: center; 
      border-bottom: 1px solid var(--border);
      background: radial-gradient(circle at 20% 30%, rgba(124,77,255,0.35), transparent 60%),
                  radial-gradient(circle at 80% 20%, rgba(233,30,99,0.35), transparent 60%),
                  linear-gradient(135deg, #1a1a1f, #0f0f12 70%);
    }
    
    /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .brand-badge {
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: #fff; 
      padding: 8px 20px; 
      border-radius: 999px;
      font-size: 18px; 
      font-weight: bold; 
      letter-spacing: 1px;
      box-shadow: 0 8px 30px rgba(124,77,255,.4);
      animation: glow 2s infinite alternate;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      display: inline-block;
      margin: 10px 0;
      min-width: 120px;
    }
    
    .brand-badge:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 35px rgba(233,30,99,.5);
    }
    
    .brand-badge:active {
      transform: scale(0.95);
    }
    
    @keyframes glow { 
      from { box-shadow: 0 0 10px rgba(124,77,255,.4); } 
      to { box-shadow: 0 0 20px rgba(233,30,99,.6); } 
    }
    
    /* Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª - ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ */
    .ads-carousel {
      display: none;
      position: relative;
      background: linear-gradient(135deg, #1a0b2e 0%, #2d1b69 100%);
      padding: 20px 0 30px;
      border-bottom: 2px solid var(--accent2);
      overflow: hidden;
    }
    
    .ads-header {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .ads-header h3 {
      margin: 0;
      color: #ffd700;
      font-size: 20px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    
    .carousel-container {
      position: relative;
      max-width: 850px;
      margin: 0 auto;
      height: 300px;
      overflow: hidden;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    
    .carousel-slides {
      display: flex;
      height: 100%;
      width: 100%;
      transition: transform 0.5s ease-in-out;
    }
    
    .carousel-slide {
      flex: 0 0 100%;
      min-width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 20px;
      position: relative;
    }
    
    .ad-content {
      display: flex;
      align-items: center;
      gap: 40px;
      max-width: 750px;
      width: 100%;
      padding: 25px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .ad-image-wrapper {
      flex: 0 0 240px;
      height: 240px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.05);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
      position: relative;
    }
    
    .ad-image {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      padding: 10px;
      background: rgba(255, 255, 255, 0.02);
      opacity: 1;
      transition: opacity 0.3s ease;
    }
    
    .ad-details {
      flex: 1;
      color: white;
      min-width: 350px;
    }
    
    .ad-name {
      font-size: 26px;
      font-weight: bold;
      margin: 0 0 20px 0;
      color: #fff;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.7);
      line-height: 1.3;
    }
    
    .ad-description {
      font-size: 16px;
      color: #e6e6e6;
      margin: 0 0 25px 0;
      line-height: 1.6;
      min-height: 80px;
    }
    
    .ad-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: white;
      padding: 10px 25px;
      border-radius: 25px;
      font-size: 15px;
      font-weight: bold;
      box-shadow: 0 6px 15px rgba(124, 77, 255, 0.4);
      transition: all 0.3s ease;
    }
    
    .ad-badge:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(233, 30, 99, 0.5);
    }
    
    /* Ø£Ø³Ù‡Ù… Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ */
    .carousel-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(124, 77, 255, 0.85);
      color: white;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      font-size: 26px;
      cursor: pointer;
      z-index: 100;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(5px);
    }
    
    .carousel-arrow:hover {
      background: var(--accent1);
      transform: translateY(-50%) scale(1.2);
      box-shadow: 0 0 25px rgba(233, 30, 99, 0.6);
    }
    
    .carousel-arrow.prev {
      right: 20px;
    }
    
    .carousel-arrow.next {
      left: 20px;
    }
    
    /* Ù†Ù‚Ø§Ø· Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ */
    .carousel-dots {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 25px;
    }
    
    .carousel-dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.25);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    
    .carousel-dot.active {
      background: #ffd700;
      transform: scale(1.4);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
      border-color: rgba(255, 255, 255, 0.3);
    }
    
    .carousel-dot:hover {
      background: var(--accent1);
      transform: scale(1.3);
    }
    
    .container { 
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 15px; 
    }

    /* ØªØ­Ø³ÙŠÙ† ØªØ®Ø·ÙŠØ· Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
    .sections {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 15px;
      animation: fadeIn 0.6s ease;
    }
    
    .section-card {
      background: #191922; 
      border: 1px solid var(--border); 
      border-radius: 8px;
      padding: 12px 8px;
      cursor: pointer; 
      transition: all .25s ease; 
      color: #eaeaf3;
      text-align: center;
      font-size: 14px;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      word-break: break-word;
    }
    
    .section-card:hover { 
      transform: translateY(-3px); 
      background: linear-gradient(135deg, var(--accent1), var(--accent2)); 
      color: #fff; 
    }

    /* Dropdown */
    .dropdown { 
      display: none; 
      margin: 15px auto; 
      text-align: center; 
      animation: slideDown 0.5s ease; 
      width: 100%;
      max-width: 300px;
    }
    
    .dropdown select {
      padding: 10px 14px; 
      border-radius: 10px; 
      border: 1px solid var(--border);
      background: #191922; 
      color: #fff; 
      font-size: 15px; 
      width: 100%;
      box-shadow: 0 8px 24px rgba(0,0,0,.25); 
      transition: all .3s ease;
      text-align: center; 
      text-align-last: center;
    }
    
    .dropdown select option { 
      color: #000; 
      background: #fff; 
      text-align: center; 
      padding: 5px;
    }

    /* Animations */
    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes slideDown { 
      from { opacity: 0; transform: translateY(-10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }

    /* ØªØ­Ø³ÙŠÙ† ØªØ®Ø·ÙŠØ· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
    .products-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-top: 20px; 
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .products-header h2 { 
      margin: 0; 
      font-size: 18px; 
      flex-grow: 1;
    }
    
    .refresh {
      background: linear-gradient(135deg, var(--accent3), var(--accent2));
      color: #fff; 
      border: none; 
      border-radius: 8px; 
      padding: 8px 14px;
      cursor: pointer; 
      font-weight: bold;
      font-size: 14px;
      white-space: nowrap;
    }
    
    .refresh:hover {
      opacity: 0.9;
    }
    
    .products { 
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
      gap: 15px;
      margin-top: 10px;
    }
    
    @media (max-width: 900px) {
      .carousel-container {
        max-width: 95%;
        height: 280px;
      }
      
      .ad-content {
        gap: 30px;
        padding: 20px;
      }
      
      .ad-image-wrapper {
        flex: 0 0 200px;
        height: 200px;
      }
      
      .ad-name {
        font-size: 22px;
      }
      
      .ad-description {
        font-size: 15px;
      }
    }
    
    @media (max-width: 768px) {
      .carousel-container {
        height: 400px;
      }
      
      .carousel-slide {
        padding: 0 15px;
      }
      
      .ad-content {
        flex-direction: column;
        text-align: center;
        gap: 25px;
        padding: 25px;
      }
      
      .ad-image-wrapper {
        width: 200px;
        height: 200px;
        margin: 0 auto;
      }
      
      .ad-details {
        min-width: auto;
        width: 100%;
      }
      
      .ad-name {
        font-size: 24px;
        margin-bottom: 15px;
      }
      
      .ad-description {
        font-size: 15px;
        margin-bottom: 20px;
      }
      
      .carousel-arrow {
        width: 45px;
        height: 45px;
        font-size: 22px;
      }
      
      .products { 
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
        gap: 12px;
      }
      
      .sections {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
    }
    
    @media (max-width: 480px) {
      .carousel-container {
        height: 450px;
      }
      
      .carousel-slide {
        padding: 0 10px;
      }
      
      .ad-image-wrapper {
        width: 180px;
        height: 180px;
      }
      
      .ad-name {
        font-size: 20px;
      }
      
      .ad-description {
        font-size: 14px;
      }
      
      .carousel-arrow {
        width: 40px;
        height: 40px;
        font-size: 20px;
      }
      
      .carousel-arrow.prev {
        right: 10px;
      }
      
      .carousel-arrow.next {
        left: 10px;
      }
      
      .products { 
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
        gap: 10px;
      }
      
      .sections {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      }
      
      .main-header {
        padding: 20px 15px;
      }
    }
    
    /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ§Ù„ØµÙˆØ± */
    .card {
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 10px;
      overflow: hidden; 
      transition: all .2s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .card:hover { 
      transform: translateY(-3px); 
      border-color: #3b3b45; 
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .image-container {
      width: 100%;
      height: 180px;
      overflow: hidden;
      background: linear-gradient(135deg, #2a2a31, #3a3a45);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .thumb { 
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      padding: 15px;
    }
    
    .card:hover .thumb {
      transform: scale(1.05);
      transition: transform 0.3s ease;
    }
    
    .content { 
      padding: 12px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    
    .name { 
      margin: 0 0 5px 0; 
      font-size: 15px; 
      font-weight: bold;
      height: 20px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .desc { 
      margin: 0 0 8px 0; 
      font-size: 12px; 
      color: var(--muted); 
      flex-grow: 1;
      height: 36px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      line-height: 1.4;
    }
    
    .price { 
      display: inline-block; 
      font-weight: bold; 
      color: #ff77a9; 
      background: rgba(233,30,99,.08); 
      border-radius: 6px; 
      padding: 4px 8px; 
      font-size: 13px;
      margin-top: 5px;
      align-self: flex-start;
    }
    
    .badge { 
      display: inline-block; 
      background: #22232b; 
      color: #b6b7c0; 
      border: 1px solid #2f3037; 
      border-radius: 6px; 
      padding: 3px 8px; 
      font-size: 11px; 
      margin-top: 6px;
      align-self: flex-start;
    }
    
    .empty { 
      color: var(--muted); 
      background: #141419; 
      border: 1px dashed #34343b; 
      border-radius: 10px; 
      padding: 20px; 
      text-align: center; 
      grid-column: 1 / -1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 200px;
    }
    
    .empty-icon {
      font-size: 40px;
      margin-bottom: 10px;
      color: var(--accent2);
    }
    
    footer { 
      text-align: center; 
      color: var(--muted); 
      padding: 20px; 
      margin-top: 30px;
      border-top: 1px solid var(--border);
      font-size: 14px;
    }
    
    h1 {
      margin: 0 0 10px;
      font-size: 24px;
    }
    
    .lead {
      margin: 5px 0;
      color: #e0e0e0;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ (Ø§Ù„ØªØ±Ø­ÙŠØ¨) -->
  <header class="main-header">
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ø¨ØªÙƒØ© ğŸ›ï¸</h1>
    <div class="brand">
      <button class="brand-badge" id="homeButton">BTikka</button>
    </div>
    <p class="lead">ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„ØªØ³ÙˆÙ‚ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ±Ø§Ø­Ø© âœ¨</p>
    <p class="lead">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ³ÙˆÙ‚ Ù…Ù†Ù‡ ğŸ‘‡</p>
  </header>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ (ÙƒØ§Ø±ÙˆØ³ÙŠÙ„) -->
  <div class="ads-carousel" id="adsCarousel">
    <div class="ads-header">
      <h3>ğŸ† Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ø¯ÙŠÙ†Ø§</h3>
    </div>
    <div class="carousel-container">
      <div class="carousel-slides" id="carouselSlides">
        <!-- Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
      </div>
      <button class="carousel-arrow prev" id="prevBtn">â€¹</button>
      <button class="carousel-arrow next" id="nextBtn">â€º</button>
    </div>
    <div class="carousel-dots" id="carouselDots">
      <!-- Ø§Ù„Ù†Ù‚Ø§Ø· ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
    </div>
  </div>

  <div class="container">
    <div class="sections" id="sections"></div>
    <div class="dropdown" id="dropdown"><select id="dropdownSelect"></select></div>

    <div class="products-header">
      <h2 id="current-section">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
      <button class="refresh" id="refresh">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
    </div>
    <div class="products" id="products"></div>
  </div>

  <footer>Â© BTikka â€” ØªØ³ÙˆÙ‚Ùƒ Ø£Ø³Ù‡Ù„ Ù…Ø¹Ù†Ø§</footer>

  <script>
    const SECTIONS = [
      "ğŸ° Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª",
      "ğŸ›ï¸ Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª â€“ Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©",
      "âš¡ Ø£Ø¯ÙˆØ§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ",
      "ğŸ”Œ Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©",
      "ğŸ½ï¸ Ø§Ø¯ÙˆØ§Øª Ø¨Ù„Ø§Ø³ØªÙŠÙƒÙŠØ©",
      "ğŸ Ù‡Ø¯Ø§ÙŠØ§",
      "ğŸ—ï¸ Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØªØ´Ø·ÙŠØ¨",
      "ğŸ’Š Ø£Ø¯ÙˆÙŠØ© ÙˆÙ…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø·Ø¨ÙŠØ©"
    ];

    // Ø¹Ù†Ø§ØµØ± DOM
    const secEl = document.getElementById("sections");
    const dropdown = document.getElementById("dropdown");
    const dropdownSelect = document.getElementById("dropdownSelect");
    const prodEl = document.getElementById("products");
    const titleEl = document.getElementById("current-section");
    const refreshBtn = document.getElementById("refresh");
    const homeButton = document.getElementById("homeButton");
    const adsCarousel = document.getElementById("adsCarousel");
    const carouselSlides = document.getElementById("carouselSlides");
    const carouselDots = document.getElementById("carouselDots");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    let currentSlide = 0;
    let slideInterval;
    let featuredShops = [];
    let allProducts = [];

    // ========== Ø¯Ø§Ù„Ø§Øª Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ ==========

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    async function initCarousel() {
      try {
        console.log('Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„...');
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        const settings = await fetchSettings();
        const headerMode = settings.header_mode || "welcome";
        console.log('ÙˆØ¶Ø¹ Ø§Ù„Ø±Ø£Ø³:', headerMode);
        
        if (headerMode === "welcome") {
          adsCarousel.style.display = "none";
          return;
        }
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
        featuredShops = await fetchFeaturedShops();
        console.log('Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ø§Ù„Ù…Ø­Ù…Ù„Ø©:', featuredShops.length, featuredShops);
        
        if (!featuredShops || featuredShops.length === 0) {
          console.log('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ù„Ø§Øª Ù…Ù…ÙŠØ²Ø© Ù„Ø¹Ø±Ø¶Ù‡Ø§');
          adsCarousel.style.display = "none";
          return;
        }
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        try {
          allProducts = await fetchProductsJson();
          console.log('Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©:', allProducts.length);
        } catch (e) {
          console.warn('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');
          allProducts = [];
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
        adsCarousel.style.display = "block";
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        currentSlide = 0;
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
        createCarousel();
        
        console.log('Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„ØŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­:', featuredShops.length);
        
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„:", err);
        adsCarousel.style.display = "none";
      }
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    function createCarousel() {
      // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø¯ÙŠÙ…
      carouselSlides.innerHTML = "";
      carouselDots.innerHTML = "";
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­
      featuredShops.forEach((shop, index) => {
        if (!shop) return;
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø±ÙŠØ­Ø©
        const slide = document.createElement("div");
        slide.className = "carousel-slide";
        slide.dataset.index = index;
        slide.style.cursor = "pointer";
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„
        const shopName = shop.name || "Ù…Ø­Ù„ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
        const shopPhoto = shop.photo || getDefaultImage(index);
        const shopDescription = shop.description || "Ù…Ø­Ù„ Ù…Ù…ÙŠØ² ÙÙŠ Ù…ØªØ¬Ø± Ø¨ØªÙƒØ©";
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø´Ø±ÙŠØ­Ø©
        slide.innerHTML = `
          <div class="ad-content">
            <div class="ad-image-wrapper">
              <img class="ad-image" 
                   src="${shopPhoto}" 
                   alt="${shopName}"
                   loading="lazy"
                   data-index="${index}"
                   onload="onCarouselImageLoad(this)"
                   onerror="onCarouselImageError(this)">
            </div>
            <div class="ad-details">
              <h3 class="ad-name">${shopName}</h3>
              <p class="ad-description">${shopDescription}</p>
              <div class="ad-badge">â­ Ù…Ø­Ù„ Ù…Ù…ÙŠØ²</div>
            </div>
          </div>
        `;
        
        // Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø±
        slide.addEventListener('click', () => {
          goToShopProducts(shopName);
        });
        
        carouselSlides.appendChild(slide);
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù‚Ø·Ø© Ø§Ù„ØªÙ†Ù‚Ù„
        const dot = document.createElement("span");
        dot.className = "carousel-dot";
        dot.dataset.index = index;
        dot.addEventListener('click', () => goToSlide(index));
        carouselDots.appendChild(dot);
      });
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
      updateCarousel();
      
      // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
      startCarousel();
    }

    // Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…Ø®ØªÙ„ÙØ© Ù„ÙƒÙ„ Ù…Ø­Ù„
    function getDefaultImage(index) {
      const colors = ['7c4dff', 'e91e63', '00c2ff', '4CAF50', 'FF9800'];
      const color = colors[index % colors.length];
      return `https://via.placeholder.com/400x300/${color}/ffffff?text=Ù…Ø­Ù„+${index + 1}`;
    }

    // Ø­Ø¯Ø« ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­
    function onCarouselImageLoad(imgElement) {
      const index = imgElement.dataset.index;
      console.log(`ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­Ù„ ${index} Ø¨Ù†Ø¬Ø§Ø­`);
      imgElement.style.opacity = "1";
      imgElement.parentElement.style.background = "rgba(255, 255, 255, 0.05)";
    }

    // Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
    function onCarouselImageError(imgElement) {
      const index = imgElement.dataset.index;
      console.warn(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­Ù„ ${index}:`, imgElement.src);
      
      // Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…Ø®ØªÙ„ÙØ© Ù„ÙƒÙ„ Ù…Ø­Ù„
      imgElement.src = getDefaultImage(parseInt(index));
      imgElement.onerror = null; // Ù…Ù†Ø¹ Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
      
      // ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ± ØªØ­Ù…ÙŠÙ„
      imgElement.style.opacity = "0.8";
      imgElement.parentElement.style.background = "rgba(255, 255, 255, 0.1)";
      
      setTimeout(() => {
        imgElement.style.opacity = "1";
        imgElement.parentElement.style.background = "rgba(255, 255, 255, 0.05)";
      }, 300);
    }

    // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
    function updateCarousel() {
      if (!carouselSlides || !featuredShops || featuredShops.length === 0) return;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ø´Ø·Ø©
      document.querySelectorAll('.carousel-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlide);
      });
      
      // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­
      carouselSlides.style.transform = `translateX(-${currentSlide * 100}%)`;
      
      console.log('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ØŒ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ù†Ø´Ø·Ø©:', currentSlide);
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø´Ø±ÙŠØ­Ø© Ù…Ø­Ø¯Ø¯Ø©
    function goToSlide(index) {
      if (!featuredShops || featuredShops.length === 0) return;
      
      // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙÙ‡Ø±Ø³ ØµØ§Ù„Ø­
      if (index < 0) index = featuredShops.length - 1;
      if (index >= featuredShops.length) index = 0;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      currentSlide = index;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
      updateCarousel();
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
      resetCarouselInterval();
      
      console.log('Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø±ÙŠØ­Ø©:', index);
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
    function nextSlide() {
      goToSlide(currentSlide + 1);
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    function prevSlide() {
      goToSlide(currentSlide - 1);
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    function startCarousel() {
      clearInterval(slideInterval);
      if (featuredShops && featuredShops.length > 1) {
        slideInterval = setInterval(nextSlide, 7000);
        console.log('Ø¨Ø¯Ø£ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');
      }
    }

    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
    function resetCarouselInterval() {
      clearInterval(slideInterval);
      startCarousel();
    }

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø­Ù„
    function checkShopExists(shopName) {
      if (!shopName) return false;
      
      // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
      const existsInProducts = allProducts.some(product => 
        product.shop && product.shop.trim() === shopName.trim()
      );
      
      // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
      const existsInFeatured = featuredShops.some(shop => 
        shop && shop.name && shop.name.trim() === shopName.trim()
      );
      
      return existsInProducts || existsInFeatured;
    }

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ù„
    function goToShopProducts(shopName) {
      console.log('Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ù„:', shopName);
      
      // 1. Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
      secEl.style.display = "none";
      dropdown.style.display = "block";
      
      // 2. Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      const restaurantSection = "ğŸ° Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª";
      dropdownSelect.value = restaurantSection;
      
      // 3. Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      showSection(restaurantSection);
      
      // 4. Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù…ØŒ Ù†Ù†ØªÙ‚Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…Ø­Ù„
      setTimeout(() => {
        const shopCards = document.querySelectorAll('.card');
        let found = false;
        
        shopCards.forEach(card => {
          const cardTitle = card.querySelector('.name')?.textContent;
          if (cardTitle === shopName) {
            found = true;
            
            // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
            card.style.boxShadow = "0 0 0 3px #ffd700";
            card.style.transform = "scale(1.05)";
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
            card.onclick = () => {
              showShopProducts(restaurantSection, shopName);
            };
            
            // ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
            setTimeout(() => {
              card.scrollIntoView({ behavior: 'smooth', block: 'center' });
              card.click();
            }, 500);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ²
            setTimeout(() => {
              card.style.boxShadow = "";
              card.style.transform = "";
            }, 3500);
          }
        });
        
        // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø§Ù„Ù…Ø­Ù„
        if (!found) {
          setTimeout(() => {
            alert(`Ø§Ù„Ù…Ø­Ù„ "${shopName}" ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù….`);
          }, 1500);
        }
      }, 1000);
    }

    // ========== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ==========

    // Ø¬Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
    async function fetchSettings() {
      try {
        const url = `settings.json?ts=${Date.now()}`;
        const res = await fetch(url, { 
          cache: "no-store",
          headers: {
            'Accept': 'application/json',
            'Cache-Control': 'no-cache'
          }
        });
        if (!res.ok) return { header_mode: "welcome" };
        return await res.json();
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:", err);
        return { header_mode: "welcome" };
      }
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©
    async function fetchFeaturedShops() {
      try {
        // Ø¥Ø¶Ø§ÙØ© timestamp Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
        const random = Math.random().toString(36).substring(7);
        const url = `featured_shops.json?ts=${Date.now()}&r=${random}`;
        
        console.log('Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù…Ù†:', url);
        
        const res = await fetch(url, { 
          cache: "no-store",
          headers: {
            'Accept': 'application/json',
            'Cache-Control': 'no-cache, no-store, must-revalidate',
            'Pragma': 'no-cache'
          }
        });
        
        console.log('Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©:', res.status);
        
        if (!res.ok) {
          console.error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©:', res.status);
          return [];
        }
        
        const shops = await res.json();
        console.log('Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©:', shops);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ù…Ø­Ù„
        const validatedShops = shops.map((shop, index) => {
          if (!shop || typeof shop !== 'object') {
            console.warn(`Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„ÙÙ‡Ø±Ø³ ${index} ØºÙŠØ± ØµØ§Ù„Ø­`);
            return null;
          }
          
          // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
          return {
            id: shop.id || `shop-${index}`,
            name: shop.name || `Ù…Ø­Ù„ ${index + 1}`,
            photo: shop.photo || getDefaultImage(index),
            description: shop.description || "Ù…Ø­Ù„ Ù…Ù…ÙŠØ² ÙÙŠ Ù…ØªØ¬Ø± Ø¨ØªÙƒØ©",
            added_date: shop.added_date || new Date().toISOString(),
            active: shop.active !== false
          };
        }).filter(shop => shop !== null && shop.active);
        
        console.log('Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…ØµØ­Ø­Ø©:', validatedShops);
        return validatedShops;
      } catch (err) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©:", err);
        return [];
      }
    }

    async function fetchProductsJson() {
      const url = `products.json?ts=${Date.now()}`;
      const res = await fetch(url, { 
        cache: "no-store",
        headers: {
          'Accept': 'application/json',
          'Cache-Control': 'no-cache'
        }
      });
      if (!res.ok) throw new Error("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª");
      return await res.json();
    }

    // ========== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ==========

    // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    function goToHomePage() {
      secEl.style.display = "grid";
      dropdown.style.display = "none";
      dropdownSelect.selectedIndex = 0;
      showRandomProducts();
      initCarousel();
      window.scrollTo({ top: 0, behavior: 'smooth' });
      titleEl.textContent = "Ù…Ù†ØªØ¬Ø§Øª Ù…Ø®ØªØ§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ âœ¨";
    }

    // Ø¨Ù†Ø§Ø¡ Tabs + Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    SECTIONS.forEach(sec => {
      const card = document.createElement("div");
      card.className = "section-card";
      card.textContent = sec;
      card.onclick = () => {
        secEl.style.display = "none";
        dropdown.style.display = "block";
        dropdownSelect.value = sec;
        showSection(sec);
      };
      secEl.appendChild(card);

      const option = document.createElement("option");
      option.value = sec;
      option.textContent = sec;
      dropdownSelect.appendChild(option);
    });

    dropdownSelect.onchange = () => {
      const sec = dropdownSelect.value;
      showSection(sec);
    };

    function renderCard({ title, subtitle, photo, description, price, badge, onClick }) {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="image-container">
          <img class="thumb" src="${photo}" alt="${title}"
               loading="lazy"
               onerror="this.onerror=null; this.src='https://via.placeholder.com/400x300/ffffff/000000?text=BTikka'">
        </div>
        <div class="content">
          <h3 class="name">${title}</h3>
          ${subtitle ? `<div class="badge">${subtitle}</div>` : ""}
          <p class="desc">${description || ""}</p>
          ${price ? `<span class="price">Ø§Ù„Ø³Ø¹Ø±: ${price} Ù„.Ø³</span>` : ""}
          ${badge ? `<div class="badge">${badge}</div>` : ""}
        </div>
      `;
      if (onClick) {
        card.style.cursor = "pointer";
        card.onclick = onClick;
      }
      prodEl.appendChild(card);
    }

    // Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„: Ù…Ù†ØªØ¬Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ù†ÙˆØ¹ product (Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª)
    async function showRandomProducts() {
      titleEl.textContent = "Ù…Ù†ØªØ¬Ø§Øª Ù…Ø®ØªØ§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ âœ¨";
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const productsOnly = items.filter(i => (i.kind || "product") === "product");
        const shuffled = [...productsOnly].sort(() => 0.5 - Math.random());
        const selected = shuffled.slice(0, 16);
        selected.forEach(p => renderCard({
          title: p.name,
          photo: p.photo,
          description: p.description,
          price: p.price,
          badge: p.type
        }));
        if (!prodEl.children.length) {
          prodEl.innerHTML = `
            <div class="empty">
              <div class="empty-icon">âœ¨</div>
              <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù†.</p>
              <p style="font-size: 12px; margin-top: 10px;">Ø³ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹!</p>
            </div>`;
        }
      } catch (err) {
        prodEl.innerHTML = `
          <div class="empty">
            <div class="empty-icon">âš ï¸</div>
            <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>
            <p style="font-size: 12px; margin-top: 10px;">Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹</p>
          </div>`;
        console.error(err);
      }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
    async function showSection(section) {
      titleEl.textContent = `Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€” ${section}`;
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const secItems = items.filter(i => (i.section || "").trim() === section.trim());

        if (section.includes("Ù…Ø·Ø§Ø¹Ù… ÙˆØ­Ù„ÙˆÙŠØ§Øª")) {
          const shops = secItems.filter(i => i.kind === "shop");
          const products = secItems.filter(i => (i.kind || "product") === "product");

          if (shops.length === 0 && products.length === 0) {
            prodEl.innerHTML = `
              <div class="empty">
                <div class="empty-icon">âœ¨</div>
                <p>Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø³ÙˆÙ ØªÙ†Ø²Ù„ Ø§Ù„Ù…Ø­Ù„Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
                <p style="font-size: 12px; margin-top: 10px;">ÙÙŠ Ù‚Ø³Ù… "${section}"</p>
              </div>`;
            return;
          }

          shops.forEach(shop => renderCard({
            title: shop.shop,
            subtitle: shop.type,
            photo: shop.photo,
            description: shop.description,
            badge: "Ù…Ø­Ù„",
            onClick: () => showShopProducts(section, shop.shop)
          }));

          if (shops.length === 0 && products.length > 0) {
            products.forEach(p => renderCard({
              title: p.name,
              photo: p.photo,
              description: p.description,
              price: p.price,
              badge: p.type
            }));
          }
        } else {
          const products = secItems.filter(i => (i.kind || "product") === "product");
          if (products.length === 0) {
            prodEl.innerHTML = `
              <div class="empty">
                <div class="empty-icon">âœ¨</div>
                <p>Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø³ÙˆÙ ØªÙ†Ø²Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
                <p style="font-size: 12px; margin-top: 10px;">ÙÙŠ Ù‚Ø³Ù… "${section}"</p>
              </div>`;
            return;
          }
          products.forEach(p => renderCard({
            title: p.name,
            photo: p.photo,
            description: p.description,
            price: p.price,
            badge: p.type
          }));
        }

        prodEl.scrollIntoView({ behavior: "smooth", block: "start" });
      } catch (err) {
        prodEl.innerHTML = `
          <div class="empty">
            <div class="empty-icon">âš ï¸</div>
            <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>
            <p style="font-size: 12px; margin-top: 10px;">Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§</p>
          </div>`;
        console.error(err);
      }
    }

    // Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø­Ù„ Ù…Ø­Ø¯Ø¯ Ø¯Ø§Ø®Ù„ Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
    async function showShopProducts(section, shopName) {
      titleEl.textContent = `Ù…Ù†ØªØ¬Ø§Øª â€” ${section} / ${shopName}`;
      prodEl.innerHTML = "";
      try {
        const items = await fetchProductsJson();
        const products = items.filter(
          i => (i.section || "").trim() === section.trim() &&
               (i.kind || "product") === "product" &&
               (i.shop || "").trim() === shopName.trim()
        );

        if (products.length === 0) {
          prodEl.innerHTML = `
            <div class="empty">
              <div class="empty-icon">ğŸª</div>
              <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ù„ Ø­Ø§Ù„ÙŠÙ‹Ø§.</p>
            </div>`;
          return;
        }

        products.forEach(p => renderCard({
          title: p.name,
          photo: p.photo,
          description: p.description,
          price: p.price,
          badge: p.type
        }));
      } catch (err) {
        prodEl.innerHTML = `
          <div class="empty">
            <div class="empty-icon">âš ï¸</div>
            <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>
            <p style="font-size: 12px; margin-top: 10px;">Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§</p>
          </div>`;
        console.error(err);
      }
    }

    // Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
    refreshBtn.onclick = async () => {
      const t = titleEl.textContent;
      if (t.includes("â€”")) {
        const afterDash = t.split("â€”")[1].trim();
        if (afterDash.includes("/")) {
          const [section, shop] = afterDash.split("/").map(s => s.trim());
          showShopProducts(section, shop);
        } else {
          showSection(afterDash);
        }
      } else {
        showRandomProducts();
      }
      await initCarousel();
    };

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø£ÙˆÙ„ Ù…Ø±Ø©
    document.addEventListener("DOMContentLoaded", async () => {
      console.log('Ø§Ù„ØµÙØ­Ø© ØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§ØŒ Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...');
      secEl.style.display = "grid";
      dropdown.style.display = "none";
      showRandomProducts();
      
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„
      await initCarousel();
      
      // Ø¥Ø¶Ø§ÙØ© Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
      homeButton.addEventListener("click", goToHomePage);
      prevBtn.addEventListener("click", () => {
        prevSlide();
        resetCarouselInterval();
      });
      nextBtn.addEventListener("click", () => {
        nextSlide();
        resetCarouselInterval();
      });
      
      // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ…
      adsCarousel.addEventListener("mouseenter", () => {
        clearInterval(slideInterval);
      });
      
      adsCarousel.addEventListener("mouseleave", () => {
        startCarousel();
      });
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ø±ÙˆØ³ÙŠÙ„ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
      window.addEventListener('resize', () => {
        updateCarousel();
      });
      
      // ØªØ´Ø®ÙŠØµ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
      setTimeout(() => {
        console.log('=== ØªØ´Ø®ÙŠØµ Ù†Ù‡Ø§Ø¦ÙŠ ===');
        console.log('Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©:', featuredShops.length);
        console.log('Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ù†Ø´Ø·Ø©:', currentSlide);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±
        document.querySelectorAll('.ad-image').forEach((img, i) => {
          console.log(`ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­Ù„ ${i}:`, {
            src: img.src,
            complete: img.complete,
            naturalWidth: img.naturalWidth,
            naturalHeight: img.naturalHeight,
            loaded: img.complete && img.naturalWidth > 0
          });
        });
      }, 3000);
    });

    // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ø§Ù…
    window.onCarouselImageLoad = onCarouselImageLoad;
    window.onCarouselImageError = onCarouselImageError;
  </script>
</body>
</html>
